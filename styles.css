/* =========================
   Reset
========================= */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
html, body {
  height: 100%;
  background: #111;
  color: #fff;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto,
    "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
}
button, input, select {
  font: inherit;
}

/* =========================
   Common
========================= */
.container { padding: 12px; }
.row { margin-bottom: 12px; }
label { display: block; margin-bottom: 6px; color: #ddd; }
input[type="text"], select, input[type="number"] {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #333;
  background: #1a1a1a;
  color: #fff;
}

.btn {
  padding: 12px 16px;
  border-radius: 10px;
  border: none;
  background: #2c7be5;
  color: white;
  font-weight: 700;
}
.btn.secondary { background: #444; }
.btn.warn { background: #c92a2a; }
.btn:active { opacity: .85; }

.grid2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.screen { display: none; }
.screen.active { display: block; }

.active-selected {
  background: #2c7be5 !important;
  color: #fff !important;
}

.endchange-row {
  margin-top: 32px;
}

/* =========================
   Guidance layout
   band1: 両数＋種別縦書き
   band2: お知らせ
   band4: 列番・行先
   band5: メニュー
   band6: 時計＋遅延＋GPS
========================= */
.screen.guidance.active {
  display: grid;
}

.guidance {
  grid-template-rows: 2.2fr 1.6fr 0.9fr 1fr 1fr 0.9fr; /* 6 段 */
  height: 100vh;
  width: 100%;
  overflow: hidden;
}

.band {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 8px;
}

/* =========================
   Band1（両数＋種別縦書き）
========================= */
.band1 {
  display: flex;
  flex-direction: row;   /* 必ず左右並び */
  align-items: stretch;
  justify-content: stretch;
  padding: 4px 6px;
}

/* 左 2/3：両数アイコン */
.band1-left {
  flex: 2;
  display: flex;
  align-items: center;
  justify-content: center;
  order: 1;             /* 両数を左側に固定 */
}

/* 右 1/3：種別縦書き */
.band1-right {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  order: 2;             /* 種別を右側に固定 */
}

/* 両数表示エリアの中央寄せ用 */
.cars-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
}

/* ひし形アイコン本体 */
.diamond {
  width:  min(27vw, 150px);
  height: min(27vw, 150px);
  transform: rotate(45deg);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 16px solid transparent;
}

.diamond span {
  font-size: clamp(28px, 10vw, 70px);
  transform: rotate(-45deg);
  font-weight: bold;
}

/* ひし形配色（両数） */
.d10 { background: #ff7f00; color: #000; }
.d8  { background: #ffd000; border-color: #000; color: #000; background-clip: padding-box; }
.d6  { background: #ff8c3a; border-color: #000; color: #000; }
.d4  { background: #0057b8; border-color: #fff; color: #fff; }
.d7  { background: #c1121f; color: #fff; }

/* ひし形アイコン画像を使う場合 */
.carIcon {
  width: 80%;
  max-width: 200px;
  object-fit: contain;
}

/* =========================
   種別バッジ（共通：横書きベース）
========================= */
.badge {
  padding: 6px 12px;
  border-radius: 10px;
  font-size: clamp(14px, 5vw, 32px);
  font-weight: 800;
  border-width: 3px;
  border-style: solid;
}

/* 種別配色 */
.j-tokkyu           { background: #d90429; color: #fff; }
.j-storea,
.j-storb_down,
.j-storb_up         { background: #fff; color: #000; border-color: #9acd32; }
.j-kaisokukyuko,
.j-chikakaiku       { background: #800080; color: #fff; }
.j-kyuko            { background: #ff7f00; color: #fff; }
.j-tsukin_kyuko     { background: #ffae00; color: #000; }
.j-kaisoku          { background: #87ceeb; color: #000; }
.j-junkyu           { background: #1f7a1f; color: #fff; }
.j-tsukin_junkyu    { background: #0057b8; color: #fff; }
.j-kukan_junkyu     { background: #9acd32; color: #000; }
.j-kakutei          { background: #808080; color: #fff; }
.j-kaiso,
.j-rinji-a          { background: #fff; color: #d90429; border-color: #d90429; }

/* =========================
   縦書き種別バッジ（上書き）
   class="badge badge-vertical j-xxx"
========================= */
.badge-vertical {
  writing-mode: vertical-rl;
  text-orientation: mixed;

  /* 文字サイズをかなり大きく（約3倍クラス） */
  font-size: clamp(24px, 10vw, 200px);
  font-weight: 900;

  /* 余白と枠も太めに */
  padding: 24px 10px;
  border-radius: 16px;
  border-width: 6px;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  max-height: 100%;
  overflow: hidden;
}

/* =========================
   Band2（お知らせ）
========================= */
.band2 {
  background: #111;
  color: #fff;
  padding: 8px;
}
.notes {
  font-size: clamp(12px, 3.8vw, 18px);
  line-height: 1.2;
}

/* GPS表示（GPS + 速度）を横並び */
.gps-row {
  display: flex;
  align-items: center;
  gap: 10px;
}
#gpsSpeed {
  font-weight: 700;
}

/* =========================
   Band3（列番・行先 + 駅間表示）
========================= */
.band3 {
  background: #111;
  display: grid;
  grid-template-columns: 1fr 1fr; /* 中央で半分 */
  gap: 8px;
  padding: 3px 8px;
  align-items: center;
}

.band3-left,
.band3-right {
  display: flex;
  align-items: center;
  justify-content: center;
}

.band3-left .traininfo {
  display: flex;   /* 横並び */
  gap: 6px;
}

/* cell（列番・行先） */
.band3 .cell {
  padding: 4px 6px;
  font-size: clamp(14px, 4.3vw, 26px);
  font-weight: 700;
  border: 1px solid #333;
}

/* 駅間表示 */
#segmentInfo {
  font-size: clamp(12px, 4.1vw, 24px);
  font-weight: 700;
  white-space: nowrap;
}

/* =========================
   Band4（発車時刻）
========================= */
.band4 {
  background: #000;
  border-top: 1px solid #333;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2px 8px;
}

.band4 #nextDepart {
  font-size: clamp(12px, 4.8vw, 36px);
  font-weight: 700;
}

/* =========================
   Band5（メニュー）
========================= */
.band5 {
  background: #000;
  display: grid;
  grid-template-columns: 1fr 5fr;
  align-items: stretch;
}

.clock {
  font-size: clamp(14px, 4.2vw, 24px);
  font-weight: 700;
}
.menu-btn {
  font-size: clamp(12px, 3.8vw, 22px);
}

/* =========================
   Band6（時刻・遅延・GPS）
========================= */
.band6 {
  background: #000;
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;  /* 時刻 / 遅延 / GPS を3列で横並び */
  align-items: center;
  justify-items: center;
  padding: 1px 8px;
}


/* =========================
   Start screen
========================= */
.centered {
  height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 14px;
}

/* =========================
   音声停止ボタン
========================= */
.btn.muted,
.btn.secondary.muted {
  background-color: #b44;
  color: #fff;
  border-color: #922;
}

.btn.muted:hover,
.btn.secondary.muted:hover {
  background-color: #a33;
}

/* =========================
   Menu modal（メニューウィンドウ）
========================= */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  display: none;                   /* ★ 初期状態では非表示 */
  align-items: center;
  justify-content: center;
  padding: 18px;
  z-index: 1000;                   /* 念のため前面に */
}

.modal.active {
  display: flex;                   /* ★ JSで .active を付けたときだけ表示 */
}

.panel {
  background: #1a1a1a;
  color: #fff;
  border-radius: 16px;
  width: min(720px, 96vw);
  max-height: 84vh;
  overflow: auto;
  padding: 16px;
  border: 1px solid #333;
}

.list {
  display: grid;
  gap: 8px;
}

.sep {
  border: none;
  border-top: 1px solid #333;
  margin: 16px 0;
}

.small {
  font-size: 12px;
  color: #aaa;
}

/* =========================
   ガイダンス画面全体の縦方向余白を圧縮
========================= */

/* 各バンド（band1〜band6）の上下パディングを小さくする */
#screen-guidance .band {
  padding-top: 0px;   /* ここを 1px にするとさらに詰まります */
  padding-bottom: 2px;
}

/* バンド同士のスキマも少しだけにする */
#screen-guidance .band + .band {
  margin-top: 0px;    /* 以前より大きければ 0〜1px にしてもOK */
}

/* band6 だけ別に指定していた場合はこちらで上書き */
#screen-guidance .band6 {
  padding-top: 1px;
  padding-bottom: 2px;
}

/* バンド内テキストの上下余白も軽く絞る */
#screen-guidance .clock,
#screen-guidance #delayInfo,
#screen-guidance #gpsStatusCompact,
#screen-guidance .notes,
#screen-guidance .traininfo .cell {
  padding-top: 0;
  padding-bottom: 0;
  line-height: 1.1;   /* デフォルトより少しだけ詰める */
}